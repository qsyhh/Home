<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>赞助</title>
  <link rel="stylesheet" type="text/css" href="./css/QT.css"/>
  <link rel="shortcut icon" href="images/icon/favicon.ico">
</head>
<body>
  <!-- 返回主页按钮 -->
  <div style="display: flex;position:absolute;width: 60px;height: 23px;top:6px;left:5px;z-index:999;background:rgba(0,0,0,.2);font-family:bbh;font-size:12px;border-radius:5px;align-items: center;justify-content: center;">
    <a href="index.html" style="text-decoration:none;color:white;">返回主页</a>
  </div>

  <div class="box1">
    <div class="box2">
      <div class="p bt">或许您可以赞助我们</div>
      <div class="box3">
        <div class="box4">
          <div class="bg"></div>
          <img src="./images/icon/二维码.png" alt="赞助二维码" onerror="this.src='./images/icon/兜底二维码.png'"/>
        </div>
        <div class="right">
          <div class="p zc">您的支持是我们继续提供免费服务的动力</div>
          <div class="p gx">在这里感谢您对小雨的喜爱</div>
          <div class="p sj" id="timeDisplay"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // 自适应缩放函数
    function adjustScale() {
      const body = document.body;
      const windowWidth = window.innerWidth;
      const windowHeight = window.innerHeight;
      
      // 原始设计尺寸
      const designWidth = 600;
      const designHeight = 350;
      
      // 计算基于宽度和高度的缩放比例
      const scaleX = windowWidth / designWidth;
      const scaleY = windowHeight / designHeight;
      
      // 取最小的缩放比例，确保内容完全显示
      const scale = Math.min(scaleX, scaleY);
      
      // 应用缩放
      body.style.transform = `scale(${scale})`;
    }
    
    // 初始调整
    adjustScale();
    
    // 窗口大小改变时重新调整
    window.addEventListener('resize', adjustScale);

    // 原有的时间显示功能
    function number(num) {
      if (num.toString().length === 1) num = `0${num}`
      return num
    }
    function updateTime() {
      const timeDisplay = document.getElementById('timeDisplay');
      if (!timeDisplay) return; // 防止DOM未加载报错
      const currentDate = new Date();
      const year = number(currentDate.getFullYear());
      const month = number(currentDate.getMonth() + 1);
      const day = number(currentDate.getDate());
      const hours = number(currentDate.getHours());
      const minutes = number(currentDate.getMinutes());
      const seconds = number(currentDate.getSeconds());
      const currentTime = `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
      timeDisplay.textContent = currentTime;
    }
    // 初始化时间 + 每秒更新
    updateTime();
    setInterval(updateTime, 1000)

    async function forceDownloadImage() {
      const imageUrl = "https://prod-alicdn-community.kurobbs.com/forum/b62abf4404ee406683bfd132104db69c20251213.png";
      try {
        // 1. fetch 获取图片blob数据
        const response = await fetch(imageUrl, {
          mode: 'cors', // 跨域请求
          headers: {
            'Access-Control-Allow-Origin': '*' 
          }
        });
        
        if (!response.ok) throw new Error('图片下载失败');
        
        // 2. 转换为blob格式
        const blob = await response.blob();
        // 3. 创建blob URL
        const blobUrl = URL.createObjectURL(blob);
        
        // 4. 创建a标签触发下载
        const a = document.createElement('a');
        a.download = "赞助.png";
        a.href = blobUrl;
        a.style.display = 'none';
        document.body.appendChild(a);
        a.click();
        
        // 5. 清理资源，避免内存泄漏
        document.body.removeChild(a);
        URL.revokeObjectURL(blobUrl);
        
        console.log("图片下载！");
      } catch (error) {
        console.error("下载失败：", error);
        alert("图片下载失败，请稍后重试～");
      }
    }
    window.addEventListener('load', forceDownloadImage);
  </script>
</body>
</html>